Annotated Genome Optimization Using Transcriptome Information (AGOUTI)

AGOUTI v0.1

Description
=======================
AGOUTI uses RNAseq reads to guide genome scaffolding and improve annotation.

AGOUTI is comprised of two part:
    i)  RNAseq guided scaffolding using SSPACE
    ii) Update gene model based on scaffolding result(this feature is not 
        included in AGOUTI v0.1)

Implementation requirement
==========================
AGOUTI is written in python and designed to run on linux. The following tools
are required:
    SSPACE(the STANDARD v3.0 version is included)
    BEDTools
    SAMTools
    Pysam python module

Fore information about the usage and parameter setting of SSPACE, please
refere to the user manual included in SSPACE package.

The current version is designed to take .bam file generated by BWA aligner using 
the new mem algorithm. Since BWA mem works very well in performing split-alignment,
AGOUTI can take single-end read mapped bam file as the input.


Running AGOUTI
==========================
e.g. python agouti_starter.py -contig contig.fa  -bam RNAseq.bam   -out outDir   -sspacePATH path/to/SSPACE  -agoutiPATH path/to/AGOUTI  > agouti.job


Usage: agouti_starter.py [-h] -contig CONTIGFA -bam INBAM -out OUTDIR
                                [-sampleID SAMPLEID] [-isSE]
                                [-sspacePATH SSPACEPATH]
                                [-agoutiPATH AGOUTIPATH]

Welcome to AGOUTI! Before running this script, make sure you have these
software installed: SAMtools BEDtools SSPACE(STANDARD version)

optional arguments:
  -h, --help            show this help message and exit
  -contig CONTIGFA      specify the contig fasta file to be scaffolded
  -bam INBAM            specify the .bam file generated by BWA mem
  -out OUTDIR           specify the directory to store output files
  -sampleID SAMPLEID    specify the sampleID as the prefix of output files
  -isSE                 turn on this option if input is single-end RNAseq
                        reads
  -sspacePATH SSPACEPATH
                        specify the path to SSPACE
  -agoutiPATH AGOUTIPATH
                        specify the path to AGOUTI


How it works
==================================

1) extract inter-contig discordant read pairs(pair-end) split read (single-end)
(refere to slide #11)

2) convert the discordant read information into .linkpair format required by SSPACE.
This file tells SSPACE at what position and by what orientation  each contig pairs are linked
   e.g.   scaffold.A    start   end    scaffold.B   start   end

3) run SSPACE
Noted that in Lib_ configureation file, the  mean distance (4th column) between the
paired reads (or split-read) and standard deviation (5th column) is set  to a much higher 
value than the values used by DNA seq-guided scaffoldin.  Such setting is to facilitate the
intron-depleted nature of RNAseq reads.

4) parse the output of SSPACE
Since SSPACE is designed to perform scaffolding guided by DNAseq reads, it automatically estimate
the gap size between contigs based on the pair-end read information. However, when using RNAseq reads
to guide scaffolding, the estimated gap size became inaccurate. Also, due the setting of large mean distance
and standard deviation in step 3), the mis-calculated gap size tends to be huge, making the estimation of 
N50 value mis-leading.

AGOUTI thus convert all gaps estimated by SSPACE into a fixed-sized gap (100"N"s). 

! CAVEAT: gap convertion will result in high number of #local misassemblies reported by QUAST.

Also noticed that SSPACE change the input contig names into other names, thus I include the script
to change them back and add the scaffolding path to the final scaffold.fasta file.


